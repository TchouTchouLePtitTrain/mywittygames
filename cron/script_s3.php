<?php/*%******************************************************************************************%*/// SETUP// Enable full-blown error reporting. http://twitter.com/rasmus/status/7448448829error_reporting(-1);// Set plain text headersheader("Content-type: text/plain; charset=utf-8");// Include the SDKrequire_once '../vendor/amazonwebservices/aws-sdk-for-php/sdk.class.php';/*%******************************************************************************************%*/// UPLOAD FILES TO S3// Instantiate the AmazonS3 class$s3 = new AmazonS3();$bucket = 'mywittygames';$response = $s3->list_objects($bucket, array(    'prefix' => 'user/',    'max-keys' => 1000000));foreach($response->body->Contents as $fichier){	print_r($fichier->Key);echo "\r\n";	$filename = substr($fichier->Key, strrpos($fichier->Key, '/') + 1, strlen($fichier->Key));	$id_user = substr($fichier->Key, strrpos($fichier->Key, 'user/') + 5, strrpos($fichier->Key, '/') - (strrpos($fichier->Key, 'user/') + 5));	print_r($filename);echo "\r\n";	print_r($id_user);echo "\r\n";	$source = 'user/'.$id_user.'/'.$filename;	$destination = 'user/'.$id_user.'/avatar/'.$filename;	//Copie	$response = $s3->copy_object(		array( // Source			'bucket'   => $bucket,			'filename' => $source		),		array( // Destination			'bucket'   => $bucket,			'filename' => $destination		)	);	echo $filename." copié dans ".$destination.". ";	//Suppression	$response = $s3->delete_object($bucket, $source);	echo $source." supprimé.\r\n";}echo 'Fin du traitement\r\n';/*// Pour vérifier$response = $s3->list_objects($bucket, array(    'prefix' => 'user/',    'max-keys' => 1000000));foreach($response->body->Contents as $fichier){	if (strpos($fichier->Key, 'avatar/avatar') > 0) print_r($fichier); }*/?>